/* @preserve Version 0.1, Copyright (c) 2015 David A Krauth */
!function(e){var t=[31,28,31,30,31,30,31,31,30,31,30,31],a={days_of_week:["Su","Mo","Tu","We","Th","Fr","Sa"],month_names:["January","February","March","April","May","June","July","August","September","October","November","December"],day_post_create:null,year_range:"-50",month_tag:"div",month_class:"month",week_tag:"div",week_class:"week",day_tag:"div",day_class:"day",day_num_tag:"span",day_num_class:"day-num",weekday_wrapper_tag:"div",weekday_wrapper_class:"weekdays",weekday_tag:"span",selector_tag:"div",selector_class:"selector",selector_month_class:"month-select",selector_year_class:"year-select"},n={create:function(e,t){var a=document.createElement(e);for(var n in t)t.hasOwnProperty(n)&&(a[n]=t[n]);return a},option:function(e,t){return this.create("option",{textContent:e,value:t})}},r={is_leap:function(e){return e%4==0&&(e%100!=0||e%400==0)},last_day:function(e,a){return t[a]+(1==a&&this.is_leap(e)?1:0)},merge:function(){for(var e,t={},a=0;a<arguments.length;a++){e=arguments[a];for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}return t},is_date:function(e){return"[object Date]"===Object.prototype.toString.call(e)},is_string:function(e){return"string"==typeof e},is_array:function(e){return"[object Array]"===Object.prototype.toString.call(e)},pad:function(e){return(10>e?"0":"")+e},DOM:n},s=function(e){var t=n.create(e.weekday_wrapper_tag,{className:e.weekday_wrapper_class});return e.days_of_week.forEach(function(a){t.appendChild(n.create(e.weekday_tag,{textContent:a}))}),t},o=function(e,t){var a,n,r=[];for(t=t||(new Date).getFullYear(),e=parseInt(e),n=0>e?-1:1,a=t+e;t!=a;t+=n)r.push(t);return r},c=function(e,t){var s,c,i,l,_=n.create(t.selector_tag,{className:t.selector_class}),p=n.create("select",{className:t.selector_month_class}),u=n.create("select",{className:t.selector_year_class}),y=function(){var e=this.parentElement.querySelector('select[data-type="month"]'),a=this.parentElement.querySelector('select[data-type="year"]'),n=this.parentElement.parentElement,r=n.querySelector("."+t.month_class),s=parseInt(e.value),o=parseInt(a.value),c=new Date(o,s);n.replaceChild(d(c,t),r)};for(p.dataset.type="month",p.addEventListener("change",y,!1),u.dataset.type="year",u.addEventListener("change",y,!1),e=e||new Date,i=e.getMonth(),_.appendChild(p),_.appendChild(u),t.month_names.forEach(function(e,t){p.appendChild(n.option(e,t)),t==i&&(p.selectedIndex=t)}),c=e.getFullYear(),l=t.year_range||a.year_range,c,r.is_string(l)&&(l=o(l,c)),s=0;s<l.length;s++)u.appendChild(n.option(l[s],l[s])),l[s]==c&&(u.selectedIndex=s);return _},i=function(e,t,a,n){this.year=e,this.month=t,this.day=a,this.is_current=!!n};i.prototype.new_day=function(e){return new i(this.year,this.month,e,this.is_current)},i.prototype.prev_month=function(){var e=this.month,t=this.year;return 0==e?(e=11,--t):--e,new i(t,e,r.last_day(t,e))},i.prototype.next_month=function(){var e=this.month,t=this.year;return 1==e?(e=0,++t):++e,new i(t,e,1)},i.prototype.toISOString=function(){return this.year+"-"+r.pad(this.month+1)+"-"+r.pad(this.day)};var l=function(e){var t,a,n,s,o=e||new Date,c=new i(o.getFullYear(),o.getMonth(),o.getDate(),!0),l=new Date(c.year,c.month).getDay(),d=[];if(l)for(n=c.prev_month(),t=n.day-l+1,a=n.day;a>=t;t++)d.push(n.new_day(t));for(t=1,a=r.last_day(c.year,c.month);a>=t;t++)d.push(c.new_day(t));if(l=d.length%7)for(s=c.next_month(),t=1,a=7-l;a>=t;t++)d.push(s.new_day(t));return d},d=function(e,t){for(var a,s,o,c=n.create(t.month_tag,{className:t.month_class}),i=l(e),d=0;d<i.length;d++)a=i[d],d%7==0&&(s=n.create(t.week_tag,{className:t.week_class}),c.appendChild(s)),o=n.create(t.day_tag,{className:t.day_class}),a.is_current||(o.className+=" other"),t.day_onclick&&(r.is_string(t.day_onclick)?o.addEventListener("click",function(){document.getElementById(t.day_onclick).value=this.dataset.date},!1):o.addEventListener("click",t.day_onclick,!1)),o.appendChild(n.create(t.day_num_tag,{className:t.day_num_class,textContent:a.day})),o.dataset.date=a.toISOString(),s.appendChild(o),t.day_post_create&&t.day_post_create(o,a);return c};e.Almanac={create:function(e,t){var n=t.date||new Date;t=r.merge(a,t||{}),e.appendChild(c(n,t)),e.appendChild(s(t)),e.appendChild(d(n,t))},range:l,Day:i,Utils:r}}(this);